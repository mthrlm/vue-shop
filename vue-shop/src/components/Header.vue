<template>
  <header class="bg-green-800 text-white py-4 px-6">
    <div class="container mx-auto flex items-center justify-between">
      <a href="/" class="text-2xl font-bold hover:text-gray-300 transition"><svg xmlns="http://www.w3.org/2000/svg" width="80" height="79" viewBox="0 0 80 79" fill="none">
<path d="M52.4321 17.1492C49.6164 12.9244 46.3323 8.64851 42.5876 6.3588C38.1478 11.5707 37.5732 22.6277 37.5732 22.6277C34.4004 22.5856 30.0292 24.444 29.0457 26.8036C26.3412 23.1872 22.8106 19.5732 16.7527 17.3281C14.9984 22.3223 15.4687 27.3788 15.1003 34.9419C14.7064 42.9704 10.1837 54.6349 17.9315 63.0213C28.0007 73.9209 50.1391 68.9469 56.6073 64.6073C68.2565 56.7868 75.8554 47.198 69.6615 32.9106C64.4988 21.0048 54.6342 20.4451 52.4321 17.1492Z" fill="#C1CFEA"/>
<path d="M27.3828 41.3435C28.1662 41.9242 28.72 42.6023 29.2214 43.3037C29.711 44.0081 30.1092 44.7533 30.4391 45.5256C30.7667 46.3017 31.0259 47.105 31.1931 47.9473C31.3491 48.7943 31.4523 49.6638 31.3261 50.6307L31.0537 50.7463C30.2704 50.1656 29.7161 49.4877 29.2159 48.7868C28.7255 48.0817 28.3277 47.3373 27.9968 46.5626C27.6702 45.7889 27.4107 44.9848 27.2442 44.1432C27.087 43.2956 26.9842 42.426 27.1104 41.4591L27.3828 41.3435Z" fill="#373535"/>
<path d="M51.4453 31.1267C52.2287 31.7074 52.7825 32.3855 53.2831 33.0872C53.7735 33.7913 54.1717 34.5365 54.5008 35.3091C54.8292 36.0849 55.0884 36.8882 55.2547 37.7308C55.4116 38.5775 55.5148 39.447 55.3886 40.4139L55.1154 40.5299C54.3321 39.9492 53.7778 39.2712 53.2775 38.5703C52.788 37.8649 52.3893 37.1209 52.0593 36.3458C51.7319 35.5724 51.4732 34.768 51.3059 33.9267C51.1487 33.0792 51.0459 32.2096 51.1721 31.2427L51.4453 31.1267Z" fill="#373535"/>
<path d="M43.9199 50.396L40.681 51.7711C39.0715 52.4545 38.0658 50.0857 39.6753 49.4023L48.4297 45.6852C50.0763 44.9861 51.0821 47.3549 49.4355 48.0541L46.3638 49.3583L50.332 58.7041C51.0159 60.3149 48.5877 61.3897 47.888 59.7418L43.9199 50.396Z" fill="#373535"/>
<path d="M27.3527 41.6589C25.2805 42.5387 23.6435 44.9596 24.8848 47.8831C26.1189 50.7897 29.0051 51.3109 31.0772 50.4311C33.2067 49.527 34.8548 47.0805 33.6207 44.1739C32.3794 41.2504 29.4821 40.7548 27.3527 41.6589ZM32.2483 52.6202C28.8876 54.2234 24.367 53.4551 22.4417 48.9204C20.5088 44.368 23.1117 40.6199 26.5358 39.166C29.8454 37.9576 34.1831 38.7588 36.0452 43.1445C37.9077 47.531 35.4871 51.245 32.2483 52.6202Z" fill="#373535"/>
<path d="M51.3925 31.4535C49.3196 32.3337 47.6826 34.7545 48.9239 37.678C50.158 40.5846 53.0442 41.1058 55.1171 40.2257C57.2458 39.3219 58.8939 36.8754 57.6597 33.9688C56.4184 31.0453 53.5212 30.5497 51.3925 31.4535ZM56.2865 42.4155C52.9267 44.0184 48.4061 43.25 46.4807 38.7153C44.5478 34.1629 47.1507 30.4148 50.574 28.9613C53.8836 27.7529 58.223 28.5533 60.0851 32.939C61.9476 37.3255 59.5254 41.0403 56.2865 42.4155Z" fill="#373535"/>
</svg></a>
      <nav class="flex space-x-4">
        <a href="/" class="hover:text-gray-300 transition">Главная</a>
      </nav>
      <div
        class="relative"
        @mouseenter="showCart = true"
        @mouseleave="showCart = false"
      >
        <a href="/cart" class="flex items-center hover:text-gray-300 transition">
          <svg
            fill="#ffffff"
            version="1.1"
            id="Capa_1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 902.86 902.86"
            xml:space="preserve"
            stroke="#ffffff"
            class="w-6 h-6 mr-2"
          >
            <g>
              <path d="M671.504,577.829l110.485-432.609H902.86v-68H729.174L703.128,179.2L0,178.697l74.753,399.129h596.751V577.829z M685.766,247.188l-67.077,262.64H131.199L81.928,246.756L685.766,247.188z" />
              <path d="M578.418,825.641c59.961,0,108.743-48.783,108.743-108.744s-48.782-108.742-108.743-108.742H168.717 c-59.961,0-108.744,48.781-108.744,108.742s48.782,108.744,108.744,108.744c59.962,0,108.743-48.783,108.743-108.744 c0-14.4-2.821-28.152-7.927-40.742h208.069c-5.107,12.59-7.928,26.342-7.928,40.742 C469.675,776.858,518.457,825.641,578.418,825.641z M209.46,716.897c0,22.467-18.277,40.744-40.743,40.744 c-22.466,0-40.744-18.277-40.744-40.744c0-22.465,18.277-40.742,40.744-40.742C191.183,676.155,209.46,694.432,209.46,716.897z M619.162,716.897c0,22.467-18.277,40.744-40.743,40.744s-40.743-18.277-40.743-40.744c0-22.465,18.277-40.742,40.743-40.742 S619.162,694.432,619.162,716.897z" />
            </g>
          </svg>
          Корзина
        </a>
        <div
          v-if="showCart"
          class="absolute right-0 mt-2 w-64 bg-white text-black shadow-lg rounded-lg dropdown-menu"
        >
          <ul v-if="cart.length > 0" class="divide-y divide-gray-300">
            <li v-for="(item, index) in cart" :key="index" class="flex items-center p-4">
              <img :src="item.image" alt="Product Image" class="w-12 h-12 object-cover rounded-md mr-4" />
              <div>
                <h2 class="text-sm font-semibold">{{ item.name }}</h2>
                <p class="text-xs text-gray-500">Цена: {{ formattedPrice(item.price) }} ₽</p>
                <p class="text-xs text-gray-500">Количество: {{ item.quantity }}</p>
              </div>
            </li>
          </ul>
          <div v-else class="p-4 text-gray-500 text-sm">Корзина пуста.</div>
        </div>
      </div>
    </div>
  </header>
</template>

<script>
import { useCartStore } from "@/store/cartStore";
import { computed } from "vue";

export default {
  name: "Header",
  data() {
    return {
      showCart: false,
    };
  },
  setup() {
    const cartStore = useCartStore();

    // Референсы на корзину и связанные данные из Pinia
    const cart = computed(() => cartStore.cart);
    const cartCount = computed(() => cartStore.cartCount);

    return {
      cart,
      cartCount,
      formattedPrice: (price) => new Intl.NumberFormat("ru-RU").format(price),
    };
  },
};
</script>

<style scoped>
.dropdown-menu {
  z-index: 50;
}
header.bg-green-800.text-white.py-4.px-6 {
    background-color: #9d2f3a;
    height: 113px;
    border-radius: 0 0 35px 35px;
    display: flex;
}
</style>
